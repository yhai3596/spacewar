<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>部署测试 - 太空战机游戏</title>
    <link rel="stylesheet" href="style.css">
    <style>
        .test-info {
            position: fixed;
            top: 10px;
            right: 10px;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 10px;
            border-radius: 5px;
            font-size: 12px;
            z-index: 1000;
        }
        .test-log {
            max-height: 200px;
            overflow-y: auto;
            margin-top: 10px;
        }
    </style>
</head>
<body>
    <div class="test-info">
        <div>部署环境测试</div>
        <div id="gameState">游戏状态: 未知</div>
        <div id="imagesLoaded">图片加载: 未知</div>
        <div class="test-log" id="testLog"></div>
    </div>

    <canvas id="gameCanvas" width="800" height="600"></canvas>
    
    <!-- 游戏菜单 -->
    <div id="menu" class="menu">
        <h1>太空战机</h1>
        <div class="menu-buttons">
            <button id="startBtn" class="menu-btn">开始游戏</button>
            <button id="instructionsBtn" class="menu-btn">游戏说明</button>
            <div class="background-selector">
                <label>选择背景:</label>
                <select id="backgroundSelect">
                    <option value="default">默认</option>
                    <option value="background1.png">背景1</option>
                    <option value="background2.png">背景2</option>
                </select>
            </div>
        </div>
    </div>

    <!-- 游戏说明 -->
    <div id="instructions" class="menu" style="display: none;">
        <h2>游戏说明</h2>
        <div class="instructions-content">
            <p>• 移动鼠标控制战机</p>
            <p>• 战机自动射击</p>
            <p>• 收集道具提升能力</p>
            <p>• 按空格键使用炸弹</p>
            <p>• 按P键暂停游戏</p>
        </div>
        <button id="backBtn" class="menu-btn">返回菜单</button>
    </div>

    <!-- 游戏界面 -->
    <div id="gameUI" style="display: none;">
        <!-- HUD -->
        <div class="hud">
            <div class="hud-left">
                <div class="score">得分: <span id="score">0</span></div>
                <div class="level">等级: <span id="level">1</span></div>
            </div>
            <div class="hud-center">
                <div class="lives">生命: <span id="lives">3</span></div>
            </div>
            <div class="hud-right">
                <div class="bombs">炸弹: <span id="bombs">3</span></div>
            </div>
        </div>

        <!-- 道具指示器 -->
        <div class="power-indicators">
            <div class="power-indicator" id="weaponIndicator">
                <span class="power-label">武器:</span>
                <div class="power-bar">
                    <div class="power-fill" id="weaponFill"></div>
                </div>
            </div>
            <div class="power-indicator" id="speedIndicator">
                <span class="power-label">速度:</span>
                <div class="power-bar">
                    <div class="power-fill" id="speedFill"></div>
                </div>
            </div>
            <div class="power-indicator" id="shieldIndicator">
                <span class="power-label">护盾:</span>
                <div class="power-bar">
                    <div class="power-fill" id="shieldFill"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- 游戏结束界面 -->
    <div id="gameOver" class="menu" style="display: none;">
        <h2>游戏结束</h2>
        <div class="final-score">最终得分: <span id="finalScore">0</span></div>
        <div class="menu-buttons">
            <button id="restartBtn" class="menu-btn">重新开始</button>
            <button id="menuBtn" class="menu-btn">返回菜单</button>
        </div>
    </div>

    <!-- 暂停界面 -->
    <div id="pauseMenu" class="menu" style="display: none;">
        <h2>游戏暂停</h2>
        <div class="menu-buttons">
            <button id="resumeBtn" class="menu-btn">继续游戏</button>
            <button id="pauseMenuBtn" class="menu-btn">返回菜单</button>
        </div>
    </div>

    <script src="game.js"></script>
    <script>
        // 测试监控脚本
        function log(message) {
            const logElement = document.getElementById('testLog');
            const time = new Date().toLocaleTimeString();
            logElement.innerHTML += `<div>[${time}] ${message}</div>`;
            logElement.scrollTop = logElement.scrollHeight;
            console.log(`[TEST] ${message}`);
        }

        // 监控游戏状态
        function monitorGame() {
            const gameStateElement = document.getElementById('gameState');
            const imagesLoadedElement = document.getElementById('imagesLoaded');
            
            // 尝试获取游戏实例
            if (window.game) {
                gameStateElement.textContent = `游戏状态: ${window.game.gameState}`;
                imagesLoadedElement.textContent = `图片加载: ${window.game.imagesLoaded ? '完成' : '进行中'}`;
            } else {
                gameStateElement.textContent = '游戏状态: 未初始化';
                imagesLoadedElement.textContent = '图片加载: 未知';
            }
        }

        // 页面加载完成后开始监控
        window.addEventListener('load', () => {
            log('页面加载完成');
            
            // 每秒更新一次状态
            setInterval(monitorGame, 1000);
            
            // 监听游戏初始化
            setTimeout(() => {
                if (window.game) {
                    log(`游戏初始化完成，状态: ${window.game.gameState}`);
                    window.testGame = window.game; // 保存引用用于测试
                } else {
                    log('警告: 游戏未正确初始化');
                }
            }, 1000);
        });
    </script>
</body>
</html>